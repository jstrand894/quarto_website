{
  "hash": "c946f4e9b96fb1f946a324a2cf9e544f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Weather Data MT\"\nauthor: \"Jackson Strand\"\ndate: \"2024-03-22\"\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(glue)\nlibrary(lubridate)\nlibrary(ggplot2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninventory_url <- \"https://www.ncei.noaa.gov/pub/data/ghcn/daily/ghcnd-inventory.txt\"\n\ninventory <- read_table(inventory_url,\n           col_names = c(\"station\", \"lat\", \"lon\", \"variable\", \"start\", \"end\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\n── Column specification ────────────────────────────────────────────────────────\ncols(\n  station = col_character(),\n  lat = col_double(),\n  lon = col_double(),\n  variable = col_character(),\n  start = col_double(),\n  end = col_double()\n)\n```\n\n\n:::\n\n```{.r .cell-code}\ninventory\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 747,471 × 6\n   station       lat   lon variable start   end\n   <chr>       <dbl> <dbl> <chr>    <dbl> <dbl>\n 1 ACW00011604  17.1 -61.8 TMAX      1949  1949\n 2 ACW00011604  17.1 -61.8 TMIN      1949  1949\n 3 ACW00011604  17.1 -61.8 PRCP      1949  1949\n 4 ACW00011604  17.1 -61.8 SNOW      1949  1949\n 5 ACW00011604  17.1 -61.8 SNWD      1949  1949\n 6 ACW00011604  17.1 -61.8 PGTM      1949  1949\n 7 ACW00011604  17.1 -61.8 WDFG      1949  1949\n 8 ACW00011604  17.1 -61.8 WSFG      1949  1949\n 9 ACW00011604  17.1 -61.8 WT03      1949  1949\n10 ACW00011604  17.1 -61.8 WT08      1949  1949\n# ℹ 747,461 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nmy_lat <- 45.661966103346735 * 2 * pi/360\nmy_long <- -111.04939878991246 * 2 * pi/360\n\nmy_station <- \n  inventory %>%\n    mutate(lat_r = lat *2 *pi/360,\n           lon_r = lon *2 *pi/360,\n           d = 1.609344 * 3963 * acos((sin(lat_r) * sin(my_lat)) + cos(lat_r) * cos(my_lat) * cos(my_long - lon_r))) %>%\n    filter(start < 1960 & end > 2020) %>%\n    top_n(n = -1, d) %>%\n    distinct(station) %>%\n    pull(station)\n\nstation_daily <- glue(\"https://ncei.noaa.gov/pub/data/ghcn/daily/by_station/{my_station}.csv.gz\")\n\nlocal_weather <- \nread_csv(station_daily,\n         col_names = c(\"station\", \"date\", \"variable\", \"value\", \"a\", \"b\", \"c\", \"d\")) %>%\n  dplyr::select(station, date, variable, value) %>%\n  pivot_wider(names_from = \"variable\", values_from = \"value\",\n                values_fill = 0) %>%\n  dplyr::select(date, TMAX, PRCP, SNOW) %>%\n  mutate(date = ymd(date))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 253197 Columns: 8\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): station, variable, a, b, c\ndbl (3): date, value, d\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbozeman_weather <-\n  local_weather %>%\n  filter(date > \"2000-01-01\")\n\nggplot(data = bozeman_weather) +\n  geom_line(aes(x = date, y = PRCP)) +\n  theme_bw() \n```\n\n::: {.cell-output-display}\n![](weatherdata_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = bozeman_weather) +\n  geom_line(aes(x = date, y = PRCP)) +\n  geom_smooth(aes(x = date, y = PRCP), method = \"loess\", se = TRUE) +\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](weatherdata_files/figure-html/unnamed-chunk-3-2.png){width=672}\n:::\n:::\n\ntitle: \"Montana Weather Data\"\n\n---\n\n",
    "supporting": [
      "weatherdata_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}